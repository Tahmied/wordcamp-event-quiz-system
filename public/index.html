<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SatisfyHost Quiz - WordCamp Dhaka 2025</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      line-height: 1.6;
      color: #1a202c;
      user-select: none;
    }

    .container {
      background: white;
      border-radius: 24px;
      box-shadow:
        0 25px 50px -12px rgba(0, 0, 0, 0.15),
        0 0 0 1px rgba(0, 0, 0, 0.05);
      max-width: 700px;
      width: 100%;
      overflow: hidden;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .container:hover {
      transform: translateY(-2px);
      box-shadow:
        0 32px 64px -12px rgba(0, 0, 0, 0.2),
        0 0 0 1px rgba(0, 0, 0, 0.05);
    }

    .header {
      background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
      color: white;
      padding: 40px 30px 30px;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #00e599 0%, #000000 50%, #00e599 100%);
    }

    .logo {
      max-width: 200px;
      margin-bottom: 15px;
    }

    .header h1 {
      font-size: 28px;
      font-weight: 700;
      margin-bottom: 8px;
      letter-spacing: -0.02em;
    }

    .header-subtitle {
      font-size: 16px;
      opacity: 0.9;
      font-weight: 400;
    }

    .progress-bar {
      display: flex;
      justify-content: space-between;
      margin-top: 32px;
      position: relative;
      padding: 0 20px;
    }

    .progress-bar::before {
      content: '';
      position: absolute;
      top: 15px;
      left: 20px;
      right: 20px;
      height: 3px;
      background: rgba(255, 255, 255, 0.2);
      z-index: 0;
      border-radius: 2px;
    }

    .progress-fill {
      position: absolute;
      top: 15px;
      left: 20px;
      height: 3px;
      background: #00e599;
      transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      z-index: 1;
      border-radius: 2px;
    }

    .step-indicator {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: rgb(84 84 84);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 600;
      font-size: 14px;
      position: relative;
      z-index: 2;
      transition: all 0.3s ease;
      border: 2px solid transparent;
    }

    .step-indicator.active {
      background: #00e599;
      color: #000000;
      border-color: #ffffff;
      box-shadow: 0 0 0 3px rgba(0, 229, 153, 0.3);
    }

    .step-indicator.completed {
      background: #00e599;
      color: #000000;
      border-color: #ffffff;
    }

    .content {
      padding: 48px 40px 40px;
    }

    .step {
      display: none;
    }

    .step.active {
      display: block;
      animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    select {
    appearance: none;
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%234a5568' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 16px center;
    background-size: 16px;
    padding-right: 48px;
}

select:focus {
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='%2300e599' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6 9 12 15 18 9'%3e%3c/polyline%3e%3c/svg%3e");
}

.save-reminder {
    background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
    border: 2px solid #fbbf24;
    border-radius: 16px;
    padding: 24px;
    margin: 28px 0;
    display: flex;
    gap: 16px;
    align-items: flex-start;
    box-shadow: 0 4px 12px rgba(251, 191, 36, 0.15);
}

.save-reminder svg {
    flex-shrink: 0;
    margin-top: 2px;
}

.save-reminder strong {
    display: block;
    color: #92400e;
    font-size: 16px;
    margin-bottom: 8px;
}

.save-reminder p {
    color: #78350f;
    font-size: 14px;
    line-height: 1.6;
    margin: 0;
}

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    h2 {
      color: #000000;
      margin-bottom: 24px;
      font-size: 24px;
      font-weight: 700;
      letter-spacing: -0.02em;
    }

    .form-group {
      margin-bottom: 24px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: #2d3748;
      font-weight: 600;
      font-size: 14px;
    }

    input,
    select {
      width: 100%;
      padding: 14px 16px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      font-size: 15px;
      transition: all 0.3s ease;
      background: white;
      font-family: inherit;
    }

    input:focus,
    select:focus {
      outline: none;
      border-color: #00e599;
      box-shadow: 0 0 0 4px rgba(0, 229, 153, 0.15);
      background: white;
    }

    input::placeholder {
      color: #a0aec0;
    }

    .button-group {
      display: flex;
      gap: 12px;
      margin-top: 32px;
    }

    button {
      flex: 1;
      padding: 16px 30px;
      border: none;
      border-radius: 12px;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      font-family: inherit;
    }

    .btn-primary {
      background: linear-gradient(135deg, #00e599 0%, #00cc88 100%);
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(0, 229, 153, 0.3);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0, 229, 153, 0.4);
    }

    .btn-primary:active {
      transform: translateY(0);
    }

    button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
      transform: none !important;
    }

    .error-message {
      background: #fed7d7;
      color: #c53030;
      padding: 16px;
      border-radius: 12px;
      margin-bottom: 24px;
      font-size: 14px;
      display: none;
      border-left: 4px solid #e53e3e;
      box-shadow: 0 2px 8px rgba(229, 62, 62, 0.1);
    }

    .error-message.show {
      display: block;
      animation: shake 0.5s cubic-bezier(0.4, 0, 0.2, 1);
    }

    @keyframes shake {

      0%,
      100% {
        transform: translateX(0);
      }

      25% {
        transform: translateX(-5px);
      }

      75% {
        transform: translateX(5px);
      }
    }

    .loading {
      display: none;
      text-align: center;
      padding: 40px 20px;
    }

    .loading.show {
      display: block;
    }

    .spinner {
      border: 4px solid #f1f5f9;
      border-top: 4px solid #00e599;
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }

      100% {
        transform: rotate(360deg);
      }
    }

    .quiz-container {
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }

    .question-card {
      background: #f8fafc;
      padding: 28px;
      border-radius: 16px;
      margin-bottom: 28px;
      border-left: 4px solid #00e599;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04);
    }

    .question-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .question-number {
      font-size: 14px;
      font-weight: 600;
      color: #00e599;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .timer {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 18px;
      font-weight: 700;
      color: #000000;
      padding: 8px 16px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
    }

    .timer.warning {
      color: #e53e3e;
      animation: pulse 1s infinite;
    }

    @keyframes pulse {

      0%,
      100% {
        transform: scale(1);
      }

      50% {
        transform: scale(1.05);
      }
    }

    .question-text {
      font-size: 18px;
      color: #1a202c;
      font-weight: 600;
      line-height: 1.6;
      margin-bottom: 20px;
    }

    .options {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .option {
      padding: 16px 20px;
      border: 2px solid #e2e8f0;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      background: white;
      font-size: 15px;
      color: #4a5568;
    }

    .option:hover {
      border-color: #00e599;
      background: #f0fdf9;
      transform: translateX(4px);
    }

    .option.selected {
      border-color: #00e599;
      background: linear-gradient(135deg, #00e599 0%, #00cc88 100%);
      color: #000000;
      font-weight: 600;
      box-shadow: 0 4px 12px rgba(0, 229, 153, 0.3);
    }

    .success-content {
      text-align: center;
      padding: 20px 0;
    }

    .prize-image {
      max-width: 300px;
      margin: 0 auto 24px;
      border-radius: 16px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
    }

    .prize-image img {
      width: 100%;
      border-radius: 16px;
    }

    .score-display {
      background: linear-gradient(135deg, #f8fafc 0%, #edf2f7 100%);
      padding: 24px;
      border-radius: 16px;
      margin: 24px 0;
      border: 2px solid #00e599;
    }

    .score-label {
      font-size: 14px;
      color: #718096;
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
    }

    .score-value {
      font-size: 36px;
      font-weight: 700;
      color: #000000;
    }

    .token-box {
      background: linear-gradient(135deg, #f8fafc 0%, #edf2f7 100%);
      padding: 28px;
      border-radius: 16px;
      margin: 24px 0;
      border: 2px dashed #00e599;
      position: relative;
      overflow: hidden;
    }

    .token-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #00e599 0%, #000000 50%, #00e599 100%);
    }

    .token-label {
      font-size: 14px;
      color: #718096;
      margin-bottom: 12px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      font-weight: 600;
    }

    .token-code {
      font-size: 18px;
      font-weight: 700;
      color: #000000;
      word-break: break-all;
      font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
      letter-spacing: 0.02em;
    }

    .retake-notice {
      background: #fef3c7;
      padding: 20px;
      border-radius: 12px;
      margin: 24px 0;
      border-left: 4px solid #f59e0b;
      box-shadow: 0 2px 8px rgba(245, 158, 11, 0.1);
    }

    .retake-notice p {
      color: #92400e;
      font-size: 15px;
      line-height: 1.6;
      margin-bottom: 16px;
    }

    @media (max-width: 640px) {
      body {
        padding: 16px;
      }

      .container {
        border-radius: 20px;
      }

      .header {
        padding: 32px 24px 24px;
      }

      .header h1 {
        font-size: 24px;
      }

      .content {
        padding: 32px 24px;
      }

      h2 {
        font-size: 22px;
      }

      .question-text {
        font-size: 16px;
      }

      .timer {
        font-size: 16px;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <img src="https://res.cloudinary.com/dzkdemrec/image/upload/v1760702745/Untitled_design_3_cf7cgd.png"
        alt="SatisfyHost Logo" class="logo">
      <h1>Quiz Challenge</h1>
      <p class="header-subtitle">Test Your Knowledge & Win Prizes!</p>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill"></div>
        <div class="step-indicator active" id="indicator1">1</div>
        <div class="step-indicator" id="indicator2">2</div>
        <div class="step-indicator" id="indicator3">3</div>
      </div>
    </div>

    <div class="content">
      <div class="error-message" id="errorMessage"></div>
      <div class="loading" id="loading">
        <div class="spinner"></div>
        <p style="color: #666;">Processing...</p>
      </div>

      <!-- Step 1: Registration -->
      <div class="step active" id="step1">
        <h2>Register to Start Quiz</h2>
        <form id="registrationForm">
          <div class="form-group">
            <label for="name">Full Name *</label>
            <input type="text" id="name" required placeholder="Enter your full name">
          </div>
          <div class="form-group">
            <label for="email">Email *</label>
            <input type="email" id="email" required placeholder="your.email@example.com">
          </div>
          <div class="form-group">
            <label for="phone">Phone *</label>
            <input type="tel" id="phone" required placeholder="01XXXXXXXXX">
          </div>

          <div class="form-group">
              <label for="profession">Profession *</label>
              <select id="profession" required>
                  <option value="" disabled selected>Select your profession</option>
                  <option value="Web Developer">Web Developer</option>
                  <option value="Software Developer">Software Developer</option>
                  <option value="Frontend Developer">Frontend Developer</option>
                  <option value="Backend Developer">Backend Developer</option>
                  <option value="Full Stack Developer">Full Stack Developer</option>
                  <option value="DevOps Engineer">DevOps Engineer</option>
                  <option value="UI/UX Designer">UI/UX Designer</option>
                  <option value="System Administrator">System Administrator</option>
                  <option value="IT Support">IT Support</option>
                  <option value="Project Manager">Project Manager</option>
                  <option value="Digital Marketer">Digital Marketer</option>
                  <option value="Content Creator">Content Creator</option>
                  <option value="Student">Student</option>
                  <option value="Other">Other</option>
              </select>
          </div>
          
          <div class="form-group">
            <label for="company">Company *</label>
            <input type="text" id="company" placeholder="Your company name">
          </div>
        </form>

        <div class="button-group">
          <button class="btn-primary" onclick="registerUser()">Start Quiz</button>
        </div>
      </div>

      <!-- Step 2: Quiz -->
      <div class="step" id="step2">
        <div class="quiz-container" id="quizContainer"></div>
      </div>

      <!-- Step 3: Results -->
      <div class="step" id="step3">
        <div class="success-content" id="resultsContent"></div>
      </div>
    </div>
  </div>

  <script>
    const API_BASE = 'https://winswagwdc25.satisfyhost.com/api/v1';
    let currentStep = 1;
    let userToken = '';
    let questions = [];
    let currentQuestionIndex = 0;
    let answers = [];
    let timer = null;
    let timeLeft = 40;
    let totalQuizTime = 40;
    let hasRetaken = false;

    // Disable copy-paste
    document.addEventListener('copy', (e) => e.preventDefault());
    document.addEventListener('paste', (e) => e.preventDefault());
    document.addEventListener('cut', (e) => e.preventDefault());
    document.addEventListener('contextmenu', (e) => e.preventDefault());

    // Detect tab change and reload questions
    document.addEventListener('visibilitychange', () => {
      if (document.hidden && currentStep === 2 && questions.length > 0) {
        fetchQuestions();
      }
    });

    function updateProgress() {
      const progressFill = document.getElementById('progressFill');
      const percentage = ((currentStep - 1) / 2) * 100;
      progressFill.style.width = percentage + '%';

      for (let i = 1; i <= 3; i++) {
        const indicator = document.getElementById('indicator' + i);
        if (i < currentStep) {
          indicator.classList.add('completed');
          indicator.classList.remove('active');
        } else if (i === currentStep) {
          indicator.classList.add('active');
          indicator.classList.remove('completed');
        } else {
          indicator.classList.remove('active', 'completed');
        }
      }

      document.querySelectorAll('.step').forEach((step, index) => {
        step.classList.remove('active');
        if (index + 1 === currentStep) {
          step.classList.add('active');
        }
      });
    }

    function showError(message) {
      const errorDiv = document.getElementById('errorMessage');
      errorDiv.textContent = message;
      errorDiv.classList.add('show');
      setTimeout(() => {
        errorDiv.classList.remove('show');
      }, 5000);
    }

    function showLoading(show) {
      const loadingDiv = document.getElementById('loading');
      if (show) {
        loadingDiv.classList.add('show');
      } else {
        loadingDiv.classList.remove('show');
      }
    }

    async function registerUser() {
      const name = document.getElementById('name').value.trim();
      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const profession = document.getElementById('profession').value.trim();
      const company = document.getElementById('company').value.trim();

      if (!name || !email || !phone || !profession) {
        showError('Please fill in all required fields');
        return;
      }

      const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
      if (!emailRegex.test(email)) {
        showError('Please enter a valid email address');
        return;
      }

      showLoading(true);

      try {
        const response = await fetch(`${API_BASE}/users/register`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({name, email, phone, profession, company})
        });

        const data = await response.json();

        if (data.success && data.data && data.data.userToken) {
          userToken = data.data.userToken;
          localStorage.setItem('quiz_user_token', userToken);
          currentStep = 2;
          updateProgress();
          await fetchQuestions();
        } else {
          showError(data.message || 'Registration failed. Please try again.');
        }
      } catch (error) {
        showError('Network error. Please check your connection and try again.');
        console.error('Error:', error);
      } finally {
        showLoading(false);
      }
    }

    async function fetchQuestions() {
      showLoading(true);
      currentQuestionIndex = 0;
      answers = [];
      timeLeft = 40;

      try {
        const response = await fetch(`${API_BASE}/questions/getQuestions`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({userToken})
        });

        const data = await response.json();

        if (data.success && data.data) {
          questions = data.data;
          displayQuestion();
        } else {
          showError(data.message || 'Failed to load questions');
        }
      } catch (error) {
        showError('Network error. Please try again.');
        console.error('Error:', error);
      } finally {
        showLoading(false);
      }
    }

    function displayQuestion() {
      if (currentQuestionIndex >= questions.length) {
        submitAnswers();
        return;
      }

      const question = questions[currentQuestionIndex];
      const quizContainer = document.getElementById('quizContainer');

      if (currentQuestionIndex === 0) {
        timeLeft = 40;
        startTimer();
      }

      quizContainer.innerHTML = `
                                              <div class="question-card">
                                                  <div class="question-header">
                                                      <div class="question-number">Question ${currentQuestionIndex + 1} of ${questions.length}</div>
                                                      <div class="timer" id="timer">
                                                          ⏱️ <span id="timeDisplay">${timeLeft}s</span>
                                                      </div>
                                                  </div>
                                                  <div class="question-text">${question.text}</div>
                                                  <div class="options" id="options">
                                                      ${question.options.map((option, index) => `
                                                          <div class="option" onclick="selectOption(${index}, '${option.replace(/'/g, "\\'")}')" id="option${index}">
                                                              ${option}
                                                          </div>
                                                      `).join('')}
                                                  </div>
                                              </div>
                                              <div class="button-group">
                                                  <button class="btn-primary" onclick="nextQuestion()" id="nextBtn" disabled>
                                                      ${currentQuestionIndex < questions.length - 1 ? 'Next Question' : 'Submit Quiz'}
                                                  </button>
                                              </div>
                                          `;
    }

    function selectOption(index, optionText) {
      document.querySelectorAll('.option').forEach(opt => opt.classList.remove('selected'));
      document.getElementById('option' + index).classList.add('selected');

      answers[currentQuestionIndex] = {
        questionId: questions[currentQuestionIndex]._id,
        selectedOption: optionText
      };

      document.getElementById('nextBtn').disabled = false;
    }

    function startTimer() {
      if (timer) clearInterval(timer);

      timer = setInterval(() => {
        timeLeft--;
        const timeDisplay = document.getElementById('timeDisplay');
        const timerEl = document.getElementById('timer');

        if (timeDisplay) {
          timeDisplay.textContent = timeLeft + 's';
          if (timeLeft <= 10) {
            timerEl.classList.add('warning');
          }
        }

        if (timeLeft <= 0) {
          clearInterval(timer);
          submitAnswers();
        }
      }, 1000);
    }

    function nextQuestion() {
      currentQuestionIndex++;
      displayQuestion();
    }

    async function submitAnswers() {
      clearInterval(timer);
      showLoading(true);

      try {
        const response = await fetch(`${API_BASE}/questions/submitAnswers`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            userToken,
            answers: answers.filter(a => a)
          })
        });

        const data = await response.json();

        if (data.success && data.data) {
          await showResults(data.data.score);
        } else {
          showError(data.message || 'Failed to submit quiz');
        }
      } catch (error) {
        showError('Network error. Please try again.');
        console.error('Error:', error);
      } finally {
        showLoading(false);
      }
    }

    async function showResults(score) {
      currentStep = 3;
      updateProgress();

      try {
        const response = await fetch(`${API_BASE}/questions/getPrize/${userToken}`);
        const data = await response.json();

        if (data.success && data.data) {
          const resultsContent = document.getElementById('resultsContent');

          let retakeButton = '';
          if ((score === 0 || score === 1) && !hasRetaken) {
            retakeButton = `
                                                          <div class="retake-notice">
                                                              <p><strong>Want to improve your score?</strong> You have one chance to retake the quiz with new questions!</p>
                                                              <button class="btn-primary" onclick="retakeQuiz()" style="width: 100%;">Retake Quiz</button>
                                                          </div>
                                                      `;
          }

          resultsContent.innerHTML = `
                                                      <h2>🎉 Quiz Completed!</h2>
                                                      <div class="score-display">
                                                          <div class="score-label">Your Score</div>
                                                          <div class="score-value">${data.data.score} / ${questions.length}</div>
                                                      </div>

                                                      ${retakeButton}

                                                      <div class="prize-image">
                                                          <img src="${data.data.prize.image}" alt="${data.data.prize.name}">
                                                      </div>

                                                      <h2 style="margin-top: 24px;">You Won: ${data.data.prize.name}!</h2>

                                                      <div class="token-box">
                                                          <div class="token-label">Your Prize Token</div>
                                                          <div class="token-code">${data.data.token}</div>
                                                      </div>
                                                      
                                          <div class="save-reminder">

            <div>
                <strong>Important: Save Your Entry Code!</strong>
                <p>Please save this code or take a screenshot. You'll need to present this code at the WordCamp Dhaka 2025 event to claim your prize if you win.</p>
            </div>
        </div>
                                                  `;
        }
      } catch (error) {
        showError('Failed to load prize information');
        console.error('Error:', error);
      }
    }

    async function retakeQuiz() {
      if (hasRetaken) {
        showError('You have already used your retake chance');
        return;
      }

      showLoading(true);

      try {
        const response = await fetch(`${API_BASE}/questions/retakeQuiz`, {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({userToken})
        });

        const data = await response.json();

        if (data.success && data.data) {
          hasRetaken = true;
          questions = data.data;
          currentQuestionIndex = 0;
          answers = [];
          currentStep = 2;
          updateProgress();
          displayQuestion();
        } else {
          showError(data.message || 'Failed to load retake questions');
        }
      } catch (error) {
        showError('Network error. Please try again.');
        console.error('Error:', error);
      } finally {
        showLoading(false);
      }
    }

    // Initialize
    updateProgress();

    document.getElementById('registrationForm').addEventListener('submit', function (e) {
      e.preventDefault();
      registerUser();
    });

    // Check if user already has a token
    window.addEventListener('load', () => {
      const savedToken = localStorage.getItem('quiz_user_token');
      if (savedToken) {
        userToken = savedToken;
      }
    });
  </script>
</body>

</html>